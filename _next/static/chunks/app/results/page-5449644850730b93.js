(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[87],{7096:function(e,t,a){Promise.resolve().then(a.bind(a,6803))},3006:function(e,t,a){"use strict";a.d(t,{VK:function(){return o}});var s=a(7119);let r=s.Km(["planned","in_progress","done","archived"]);s.Ry({id:s.Z_(),tenantId:s.Z_(),name:s.Z_(),description:s.Z_().optional(),status:r,startDate:s.Z_().optional(),targetDate:s.Z_().optional(),completedDate:s.Z_().optional(),createdAt:s.Z_(),updatedAt:s.Z_(),createdBy:s.Z_().optional()}),s.Ry({id:s.Z_(),planId:s.Z_(),recommendationId:s.Z_(),metric:s.Z_(),scenario:s.Z_(),recommendation:s.Z_(),resources:s.Z_(),priority:s.Rx().optional(),addedAt:s.Z_(),startedAt:s.Z_().optional(),completedAt:s.Z_().optional()});let n=s.Km(["ADDED_TO_PLAN","STARTED","OUTREACH_SENT","EVENT_HELD","LEARNING_ASSIGNED","CHECKPOINT_SNAPSHOT","FEEDBACK_GIVEN","MARKED_SUCCESS","MARKED_FAIL"]);s.Ry({id:s.Z_(),planRecommendationId:s.Z_(),eventType:n,eventData:s.IM(s.Yj()).optional(),recordedAt:s.Z_(),recordedBy:s.Z_().optional()}),s.Ry({id:s.Z_(),planRecommendationId:s.Z_(),feedbackType:s.Km(["success","challenge","suggestion","quote"]),feedbackText:s.Z_(),sentiment:s.Km(["positive","neutral","negative"]).optional(),submittedAt:s.Z_(),submittedBy:s.Z_().optional()}),s.Ry({id:s.Z_(),planId:s.Z_(),metric:s.Z_(),snapshotType:s.Km(["baseline","checkpoint","final"]),value:s.G0([s.Rx(),s.Z_()]),recordedAt:s.Z_(),notes:s.Z_().optional()}),s.Ry({planRecommendationId:s.Z_(),metric:s.Z_(),scenario:s.Z_(),baselineValue:s.G0([s.Rx(),s.Z_()]),finalValue:s.G0([s.Rx(),s.Z_()]),delta:s.Rx(),deltaPercent:s.Rx(),coverage:s.Rx(),persistence:s.Rx(),evidenceScore:s.Rx(),success:s.O7(),winRate:s.Rx(),observationDays:s.Rx(),calculatedAt:s.Z_()});class i{createPlan(e){let t={...e,id:crypto.randomUUID(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return this.plans.set(t.id,t),this.saveToLocalStorage(),t}getPlan(e){return this.plans.get(e)}getPlansByTenant(e){return Array.from(this.plans.values()).filter(t=>t.tenantId===e)}updatePlan(e,t){let a=this.plans.get(e);if(!a)return;let s={...a,...t,updatedAt:new Date().toISOString()};return this.plans.set(e,s),this.saveToLocalStorage(),s}deletePlan(e){let t=this.plans.delete(e);return t&&this.saveToLocalStorage(),t}createPlanRecommendation(e){let t={...e,id:crypto.randomUUID(),addedAt:new Date().toISOString()};return this.planRecommendations.set(t.id,t),this.saveToLocalStorage(),t}getPlanRecommendation(e){return this.planRecommendations.get(e)}getPlanRecommendationsByPlan(e){return Array.from(this.planRecommendations.values()).filter(t=>t.planId===e)}updatePlanRecommendation(e,t){let a=this.planRecommendations.get(e);if(!a)return;let s={...a,...t};return this.planRecommendations.set(e,s),this.saveToLocalStorage(),s}createEvent(e){let t={...e,id:crypto.randomUUID(),recordedAt:new Date().toISOString()};return this.events.set(t.id,t),this.saveToLocalStorage(),t}getEventsByPlanRecommendation(e){return Array.from(this.events.values()).filter(t=>t.planRecommendationId===e)}getAllEvents(){return Array.from(this.events.values())}createFeedback(e){let t={...e,id:crypto.randomUUID(),submittedAt:new Date().toISOString()};return this.feedback.set(t.id,t),this.saveToLocalStorage(),t}getFeedbackByPlanRecommendation(e){return Array.from(this.feedback.values()).filter(t=>t.planRecommendationId===e)}createSnapshot(e){let t={...e,id:crypto.randomUUID(),recordedAt:new Date().toISOString()};return this.snapshots.set(t.id,t),this.saveToLocalStorage(),t}getSnapshotsByPlan(e){return Array.from(this.snapshots.values()).filter(t=>t.planId===e)}saveToLocalStorage(){try{localStorage.setItem("copilot_nav_plans",JSON.stringify(Array.from(this.plans.entries()))),localStorage.setItem("copilot_nav_plan_recs",JSON.stringify(Array.from(this.planRecommendations.entries()))),localStorage.setItem("copilot_nav_events",JSON.stringify(Array.from(this.events.entries()))),localStorage.setItem("copilot_nav_feedback",JSON.stringify(Array.from(this.feedback.entries()))),localStorage.setItem("copilot_nav_snapshots",JSON.stringify(Array.from(this.snapshots.entries())))}catch(e){console.warn("Failed to save to localStorage:",e)}}loadFromLocalStorage(){try{let e=localStorage.getItem("copilot_nav_plans"),t=localStorage.getItem("copilot_nav_plan_recs"),a=localStorage.getItem("copilot_nav_events"),s=localStorage.getItem("copilot_nav_feedback"),r=localStorage.getItem("copilot_nav_snapshots");e&&(this.plans=new Map(JSON.parse(e))),t&&(this.planRecommendations=new Map(JSON.parse(t))),a&&(this.events=new Map(JSON.parse(a))),s&&(this.feedback=new Map(JSON.parse(s))),r&&(this.snapshots=new Map(JSON.parse(r)))}catch(e){console.warn("Failed to load from localStorage:",e)}}clearAll(){this.plans.clear(),this.planRecommendations.clear(),this.events.clear(),this.feedback.clear(),this.snapshots.clear(),this.saveToLocalStorage()}constructor(){this.plans=new Map,this.planRecommendations=new Map,this.events=new Map,this.feedback=new Map,this.snapshots=new Map,this.loadFromLocalStorage()}}let l=null;function o(){return l||(l=new i),l}},8422:function(e,t,a){"use strict";a.d(t,{C:function(){return n}});var s=a(9625),r=a(6885);let n=(0,s.Ue)()((0,r.tJ)(e=>({inputs:{},setInput:(t,a)=>e(e=>({inputs:{...e.inputs,[t]:a}})),clearInputs:()=>e({inputs:{}}),results:null,setResults:t=>e({results:t}),clearResults:()=>e({results:null}),currentStep:"landing",setCurrentStep:t=>e({currentStep:t})}),{name:"copilot-adoption-storage",partialize:e=>({inputs:e.inputs,results:e.results})}))},2319:function(e,t,a){"use strict";a.d(t,{j:function(){return r},js:function(){return n}});var s=a(3006);function r(e,t){let{planRecommendationId:a,eventData:r,recordedBy:n}=t;if(!a)return console.warn("track() called without planRecommendationId"),null;let i=(0,s.VK)();try{let t=i.createEvent({planRecommendationId:a,eventType:e,eventData:r,recordedBy:n});return"STARTED"===e?i.updatePlanRecommendation(a,{startedAt:new Date().toISOString()}):("MARKED_SUCCESS"===e||"MARKED_FAIL"===e)&&i.updatePlanRecommendation(a,{completedAt:new Date().toISOString()}),console.log("[Telemetry] ".concat(e,":"),{planRecommendationId:a,eventData:r}),t}catch(e){return console.error("[Telemetry] Failed to track event:",e),null}}function n(e){return(0,s.VK)().getEventsByPlanRecommendation(e)}},6803:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return D}});var s=a(7437),r=a(2265),n=a(9376),i=a(3236),l=a(515),o=a(794),c=a(7585),d=a(5717),m=a(4949),u=a(9459),p=a(1145),g=a(5389),h=a(8286),x=a(6487),b=a(3769),v=a(8021),f=a(8422),y=a(7853),j=a.n(y);async function S(e){let t=new(j()).Workbook,a=t.addWorksheet("Copilot Adoption Tracker"),s=["Metric","Scenario","Action (Recommendation)","Resources","Baseline Metric","Post Metric","Increase","% Increase","Start Date","End Date","Status","Notes","Target","Feedback"],r=a.addRow(s);for(let t of(r.font={bold:!0,color:{argb:"FFFFFFFF"}},r.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF0078D4"}},r.alignment={vertical:"middle",horizontal:"left"},e))a.addRow([t.metric,t.scenario,t.recommendation,t.resources,t.userValue,"","","","","","","",t.target,""]);return a.columns=[25,30,60,40,15,15,12,12,15,15,15,30,15,30].map((e,t)=>({key:s[t],width:e})),a.getColumn(3).alignment={wrapText:!0,vertical:"top"},a.getColumn(4).alignment={wrapText:!0,vertical:"top"},a.views=[{state:"frozen",ySplit:1}],await t.xlsx.writeBuffer()}var w=a(3006),N=a(2319);function D(){let e=(0,n.useRouter)(),{results:t}=(0,f.C)(),[a,y]=(0,r.useState)("all"),[j,D]=(0,r.useState)("gap"),[I,A]=(0,r.useState)(!1),[C,R]=(0,r.useState)({open:!1,recId:null}),[_,k]=(0,r.useState)(""),[T,E]=(0,r.useState)({}),[P,U]=(0,r.useState)({open:!1,rec:null,template:null}),[Z,F]=(0,r.useState)({audienceSize:"",activities:{}}),O=(0,w.VK)(),M="demo-tenant-001",z=async e=>{let t=O.getPlansByTenant(M).filter(e=>"in_progress"===e.status)[0];t||(t=O.createPlan({tenantId:M,name:"Adoption Plan ".concat(new Date().toLocaleDateString()),description:"Auto-generated plan from recommendations",status:"in_progress",createdBy:"user@example.com"}));let a=O.createPlanRecommendation({planId:t.id,recommendationId:e.ruleId,metric:e.metric,scenario:e.scenario,recommendation:e.recommendation,resources:e.resources});(0,N.j)("ADDED_TO_PLAN",{planRecommendationId:a.id,eventData:{addedBy:"user@example.com"}}),E(t=>({...t,[e.ruleId]:{...t[e.ruleId],inPlan:!0}})),alert("Added to plan: ".concat(t.name))},L=e=>{let t=Array.from(O.planRecommendations.values()).filter(t=>t.recommendationId===e.ruleId)[0];if(t){let a=prompt("Enter the current (baseline) value for ".concat(e.metric,":"),e.currentValue||"0");null!==a&&(O.createSnapshot({planId:t.planId,metric:e.metric,snapshotType:"baseline",value:isNaN(Number(a))?a:Number(a)}),(0,N.j)("STARTED",{planRecommendationId:t.id,eventData:{startedBy:"user@example.com",baselineValue:a}}),E(t=>({...t,[e.ruleId]:{...t[e.ruleId],started:!0}})),alert("Recommendation started! Baseline captured. Track your progress in the Plans page."))}else alert("Please add to plan first")},B=e=>{let t=Array.from(O.planRecommendations.values()).filter(t=>t.recommendationId===e.ruleId)[0];if(t){if(!O.getSnapshotsByPlan(t.planId).some(t=>t.metric===e.metric&&"baseline"===t.snapshotType)){let a=e.currentValue||e.value||0;O.createSnapshot({planId:t.planId,metric:e.metric,snapshotType:"baseline",value:a})}let a=prompt("Enter the final value for ".concat(e.metric," after implementing this recommendation:"),e.currentValue||"0");null!==a&&(O.createSnapshot({planId:t.planId,metric:e.metric,snapshotType:"final",value:isNaN(Number(a))?a:Number(a)}),(0,N.j)("MARKED_SUCCESS",{planRecommendationId:t.id,eventData:{markedBy:"user@example.com",finalValue:a}}),E(t=>({...t,[e.ruleId]:{...t[e.ruleId],completed:"success"}})),alert("\uD83C\uDF89 Success recorded! View evidence in the Evidence page."))}else alert("Please add to plan first")},V=e=>{let t=Array.from(O.planRecommendations.values()).filter(t=>t.recommendationId===e.ruleId)[0];t?((0,N.j)("MARKED_FAIL",{planRecommendationId:t.id,eventData:{markedBy:"user@example.com"}}),E(t=>({...t,[e.ruleId]:{...t[e.ruleId],completed:"fail"}})),alert("Marked as didn't help. Your feedback helps improve recommendations.")):alert("Please add to plan first")},K=e=>{R({open:!0,recId:e}),k("")},G=e=>{let t=function(e){let t=e.toLowerCase();return t.includes("awareness")||t.includes("campaign")||t.includes("communicate")?{activities:[{id:"emailsSent",label:"Emails Sent",icon:"\uD83D\uDCE7",placeholder:"e.g., 500",description:"Users who received awareness emails"},{id:"teamsMessages",label:"Teams Messages",icon:"\uD83D\uDCAC",placeholder:"e.g., 300",description:"Users reached via Teams announcements"},{id:"eventAttendees",label:"Kickoff Event Attendees",icon:"\uD83C\uDFAF",placeholder:"e.g., 120",description:"Users who attended launch event"},{id:"yammerViews",label:"Yammer/Viva Engage Views",icon:"\uD83D\uDC41️",placeholder:"e.g., 450",description:"Users who viewed posts"}],sampleData:{audienceSize:1e3,activities:{emailsSent:500,teamsMessages:300,eventAttendees:120,yammerViews:450}},explanation:"Coverage = (Total users reached through any channel) / Total audience. If a user received both email and Teams message, count them once."}:t.includes("training")||t.includes("learning")||t.includes("course")||t.includes("academy")?{activities:[{id:"learningAssigned",label:"Learning Paths Assigned",icon:"\uD83D\uDCDA",placeholder:"e.g., 400",description:"Users assigned Copilot learning paths"},{id:"trainingCompleted",label:"Training Completed",icon:"✅",placeholder:"e.g., 280",description:"Users who finished training"},{id:"officeHoursAttendees",label:"Office Hours Attendees",icon:"\uD83C\uDF93",placeholder:"e.g., 85",description:"Users attending Q&A sessions"},{id:"certifications",label:"Certifications Earned",icon:"\uD83C\uDFC6",placeholder:"e.g., 150",description:"Users who got certified"}],sampleData:{audienceSize:800,activities:{learningAssigned:400,trainingCompleted:280,officeHoursAttendees:85,certifications:150}},explanation:"Coverage = (Unique users who engaged with learning) / Total audience. High completion rates show strong engagement."}:t.includes("champion")||t.includes("power user")||t.includes("super user")||t.includes("advocate")?{activities:[{id:"championsRecruited",label:"Champions Recruited",icon:"⭐",placeholder:"e.g., 25",description:"Users who joined champions program"},{id:"oneOnOneSessions",label:"1-on-1 Coaching Sessions",icon:"\uD83D\uDC65",placeholder:"e.g., 60",description:"Individual coaching provided"},{id:"peerSupport",label:"Peer Support Interactions",icon:"\uD83E\uDD1D",placeholder:"e.g., 150",description:"Users helped by champions"},{id:"showcaseEvents",label:"Showcase Event Attendees",icon:"\uD83C\uDFA4",placeholder:"e.g., 95",description:"Users attending demo sessions"}],sampleData:{audienceSize:500,activities:{championsRecruited:25,oneOnOneSessions:60,peerSupport:150,showcaseEvents:95}},explanation:"Coverage = (Champions + Users they helped) / Total audience. Champions create multiplier effect."}:t.includes("feature")||t.includes("copilot chat")||t.includes("word")||t.includes("excel")?{activities:[{id:"demoAttendees",label:"Feature Demo Attendees",icon:"\uD83C\uDFAC",placeholder:"e.g., 200",description:"Users who attended demos"},{id:"tipsShared",label:"Tips & Tricks Shared",icon:"\uD83D\uDCA1",placeholder:"e.g., 350",description:"Users who received tips"},{id:"useCaseGuides",label:"Use Case Guides Sent",icon:"\uD83D\uDCD6",placeholder:"e.g., 450",description:"Users who got practical guides"},{id:"pilotUsers",label:"Pilot/Early Adopters",icon:"\uD83D\uDE80",placeholder:"e.g., 75",description:"Users testing the feature"}],sampleData:{audienceSize:750,activities:{demoAttendees:200,tipsShared:350,useCaseGuides:450,pilotUsers:75}},explanation:"Coverage = (Users exposed to feature through any method) / Total audience. Multiple touchpoints increase adoption."}:t.includes("manager")||t.includes("leadership")||t.includes("executive")||t.includes("sponsor")?{activities:[{id:"managerBriefings",label:"Manager Briefings",icon:"\uD83D\uDC54",placeholder:"e.g., 45",description:"Managers who attended briefings"},{id:"teamMeetings",label:"Team Meetings with Copilot Topic",icon:"\uD83D\uDCCA",placeholder:"e.g., 180",description:"Users in teams discussing Copilot"},{id:"managerToolkits",label:"Manager Toolkits Sent",icon:"\uD83E\uDDF0",placeholder:"e.g., 45",description:"Managers with enablement materials"},{id:"teamGoalsSet",label:"Teams with Copilot Goals",icon:"\uD83C\uDFAF",placeholder:"e.g., 30",description:"Teams with adoption targets"}],sampleData:{audienceSize:600,activities:{managerBriefings:45,teamMeetings:180,managerToolkits:45,teamGoalsSet:30}},explanation:"Coverage = (Users whose managers are engaged) / Total audience. Manager activation drives team adoption."}:t.includes("use case")||t.includes("scenario")||t.includes("workflow")?{activities:[{id:"useCaseWorkshops",label:"Use Case Workshops",icon:"\uD83D\uDEE0️",placeholder:"e.g., 150",description:"Users attending hands-on workshops"},{id:"templatesShared",label:"Templates/Prompts Shared",icon:"\uD83D\uDCDD",placeholder:"e.g., 400",description:"Users who got prompt libraries"},{id:"successStories",label:"Success Stories Shared",icon:"\uD83D\uDCE2",placeholder:"e.g., 500",description:"Users who saw peer examples"},{id:"practiceSessions",label:"Practice Sessions",icon:"⚡",placeholder:"e.g., 100",description:"Users in guided practice"}],sampleData:{audienceSize:850,activities:{useCaseWorkshops:150,templatesShared:400,successStories:500,practiceSessions:100}},explanation:"Coverage = (Users exposed to practical use cases) / Total audience. Real examples accelerate adoption."}:{activities:[{id:"outreachSent",label:"Outreach Sent (emails, messages)",icon:"\uD83D\uDCE7",placeholder:"e.g., 500",description:"Users who received communications"},{id:"eventAttendees",label:"Event Attendees",icon:"\uD83C\uDFAF",placeholder:"e.g., 120",description:"Users who attended events"},{id:"learningAssigned",label:"Learning Assigned",icon:"\uD83D\uDCDA",placeholder:"e.g., 200",description:"Users assigned learning resources"},{id:"supportProvided",label:"Support/Help Provided",icon:"\uD83C\uDD98",placeholder:"e.g., 80",description:"Users who received direct help"}],sampleData:{audienceSize:1e3,activities:{outreachSent:500,eventAttendees:120,learningAssigned:200,supportProvided:80}},explanation:"Coverage = (Unique users reached through activities) / Total audience. Track all engagement touchpoints."}}(e.recommendation);U({open:!0,rec:e,template:t}),F({audienceSize:t.sampleData.audienceSize.toString(),activities:{}})};if(!t||0===t.triggered.length)return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("header",{className:"bg-white shadow-sm",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Copilot Adoption Navigator"})})}),(0,s.jsxs)("main",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-16 text-center",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"No Recommendations Found"}),(0,s.jsx)("p",{className:"text-gray-600 mb-8",children:"Based on your inputs, all metrics are within target ranges. Great job!"}),(0,s.jsxs)("button",{onClick:()=>e.push("/inputs"),className:"inline-flex items-center px-6 py-3 bg-microsoft-blue text-white font-semibold rounded-lg hover:bg-blue-600",children:[(0,s.jsx)(i.Z,{className:"mr-2",size:20}),"Back to Inputs"]})]})]});let H=Array.from(new Set(t.triggered.map(e=>e.metric))),J=[..."all"===a?t.triggered:t.triggered.filter(e=>e.metric===a)].sort((e,t)=>{if("gap"===j){let a=Math.abs(e.gap||0);return Math.abs(t.gap||0)-a}{let a={high:3,medium:2,low:1};return a[t.effort||"medium"]-a[e.effort||"medium"]}}),W=async()=>{A(!0);try{let e=await S(t.triggered);!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"copilot-adoption-tracker.xlsx",a=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),s=URL.createObjectURL(a),r=document.createElement("a");r.href=s,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)}(e)}catch(e){console.error("Error downloading Excel:",e),alert("Failed to download Excel report")}finally{A(!1)}};return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("header",{className:"bg-white shadow-sm",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex items-center justify-between",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Your Recommendations"}),(0,s.jsxs)("button",{onClick:()=>e.push("/inputs"),className:"flex items-center text-microsoft-blue hover:text-blue-700",children:[(0,s.jsx)(i.Z,{className:"mr-2",size:20}),"Edit Inputs"]})]})}),(0,s.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-3xl font-bold text-microsoft-blue",children:t.triggered.length}),(0,s.jsx)("span",{className:"ml-2 text-gray-600",children:"Recommendations"})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["Based on ",t.totalInputs," inputs"]})})]}),(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsxs)("button",{onClick:()=>e.push("/plans"),className:"flex items-center px-6 py-2 bg-microsoft-blue text-white font-semibold rounded-lg hover:bg-blue-600 transition-colors",children:[(0,s.jsx)(l.Z,{className:"mr-2",size:20,weight:"bold"}),"View Plans"]}),(0,s.jsxs)("button",{onClick:W,disabled:I,className:"flex items-center px-6 py-2 bg-microsoft-green text-white font-semibold rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:[(0,s.jsx)(o.Z,{className:"mr-2",size:20,weight:"bold"}),I?"Downloading...":"Download Excel"]})]})]})})}),(0,s.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(c.Z,{size:20,className:"text-gray-500"}),(0,s.jsxs)("select",{value:a,onChange:e=>y(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-microsoft-blue",children:[(0,s.jsx)("option",{value:"all",children:"All Metrics"}),H.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(d.Z,{size:20,className:"text-gray-500"}),(0,s.jsxs)("select",{value:j,onChange:e=>D(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-microsoft-blue",children:[(0,s.jsx)("option",{value:"gap",children:"Sort by Gap"}),(0,s.jsx)("option",{value:"effort",children:"Sort by Effort"})]})]})]})})}),(0,s.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,s.jsx)("div",{className:"space-y-6",children:J.map((e,t)=>{var a,r,n,i,l,o,c,d,b,v,f,y,j,S,w,N,D,I,A,C;return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,s.jsx)("span",{className:"px-3 py-1 bg-blue-100 text-microsoft-blue text-xs font-semibold rounded-full",children:e.metric}),e.effort&&(0,s.jsxs)("span",{className:"px-3 py-1 text-xs font-semibold rounded-full ".concat("high"===e.effort?"bg-red-100 text-red-700":"medium"===e.effort?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"),children:[e.effort.toUpperCase()," EFFORT"]})]}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.scenario})]}),(0,s.jsxs)("div",{className:"text-right ml-4",children:[(0,s.jsxs)("div",{className:"mb-2",children:[(0,s.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Your Value"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:e.userValue})]}),e.target&&(0,s.jsxs)("div",{className:"px-3 py-2 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,s.jsx)("div",{className:"text-xs font-medium text-gray-600 mb-1",children:"Target"}),(0,s.jsx)("div",{className:"text-sm font-semibold text-microsoft-blue",children:e.target})]})]})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Recommended Action:"}),(0,s.jsx)("p",{className:"text-gray-700",children:e.recommendation})]}),e.resources&&(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Resources:"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:e.resources.split(";").map((e,t)=>(0,s.jsx)("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 text-sm rounded-md",children:e.trim()},t))})]}),null!==e.gap&&void 0!==e.gap&&(0,s.jsx)("div",{className:"border-t border-gray-200 pt-4 mt-4",children:(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:["Gap to target: ",(0,s.jsx)("span",{className:"font-semibold",children:e.gap.toFixed(1)}),e.gapPercent&&(0,s.jsxs)("span",{className:"ml-2",children:["(",e.gapPercent>0?"+":"",e.gapPercent.toFixed(1),"%)"]})]})}),(0,s.jsx)("div",{className:"border-t border-gray-200 pt-4 mt-4",children:(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsxs)("button",{onClick:()=>z(e),disabled:null===(a=T[e.ruleId])||void 0===a?void 0:a.inPlan,className:"inline-flex items-center px-3 py-2 text-sm font-medium rounded-lg ".concat((null===(r=T[e.ruleId])||void 0===r?void 0:r.inPlan)?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-microsoft-blue text-white hover:bg-blue-600"),children:[(0,s.jsx)(m.Z,{size:16,className:"mr-1",weight:"bold"}),(null===(n=T[e.ruleId])||void 0===n?void 0:n.inPlan)?"In Plan":"Add to Plan"]}),(0,s.jsxs)("button",{onClick:()=>L(e),disabled:!(null===(i=T[e.ruleId])||void 0===i?void 0:i.inPlan)||(null===(l=T[e.ruleId])||void 0===l?void 0:l.started),className:"inline-flex items-center px-3 py-2 text-sm font-medium rounded-lg ".concat((null===(o=T[e.ruleId])||void 0===o?void 0:o.started)?"bg-green-100 text-green-700 cursor-not-allowed":(null===(c=T[e.ruleId])||void 0===c?void 0:c.inPlan)?"bg-microsoft-green text-white hover:bg-green-700":"bg-gray-100 text-gray-400 cursor-not-allowed"),children:[(0,s.jsx)(u.Z,{size:16,className:"mr-1",weight:"fill"}),(null===(d=T[e.ruleId])||void 0===d?void 0:d.started)?"Started":"Start"]}),(0,s.jsxs)("button",{onClick:()=>G(e),disabled:!(null===(b=T[e.ruleId])||void 0===b?void 0:b.started),className:"inline-flex items-center px-3 py-2 text-sm font-medium rounded-lg ".concat((null===(v=T[e.ruleId])||void 0===v?void 0:v.started)?"bg-purple-50 text-purple-700 border border-purple-300 hover:bg-purple-100":"bg-gray-100 text-gray-400 cursor-not-allowed"),children:[(0,s.jsx)(p.Z,{size:16,className:"mr-1",weight:"bold"}),"Log Activities"]}),(0,s.jsxs)("button",{onClick:()=>B(e),disabled:!(null===(f=T[e.ruleId])||void 0===f?void 0:f.started)||(null===(y=T[e.ruleId])||void 0===y?void 0:y.completed)==="success",className:"inline-flex items-center px-3 py-2 text-sm font-medium rounded-lg ".concat((null===(j=T[e.ruleId])||void 0===j?void 0:j.completed)==="success"?"bg-green-100 text-green-700 cursor-not-allowed":(null===(S=T[e.ruleId])||void 0===S?void 0:S.started)?"bg-green-50 text-microsoft-green border border-microsoft-green hover:bg-green-100":"bg-gray-100 text-gray-400 cursor-not-allowed"),children:[(0,s.jsx)(g.Z,{size:16,className:"mr-1",weight:"fill"}),(null===(w=T[e.ruleId])||void 0===w?void 0:w.completed)==="success"?"Success!":"Mark Success"]}),(0,s.jsxs)("button",{onClick:()=>V(e),disabled:!(null===(N=T[e.ruleId])||void 0===N?void 0:N.started)||(null===(D=T[e.ruleId])||void 0===D?void 0:D.completed)==="fail",className:"inline-flex items-center px-3 py-2 text-sm font-medium rounded-lg ".concat((null===(I=T[e.ruleId])||void 0===I?void 0:I.completed)==="fail"?"bg-red-100 text-red-700 cursor-not-allowed":(null===(A=T[e.ruleId])||void 0===A?void 0:A.started)?"bg-red-50 text-microsoft-orange border border-microsoft-orange hover:bg-red-100":"bg-gray-100 text-gray-400 cursor-not-allowed"),children:[(0,s.jsx)(h.Z,{size:16,className:"mr-1",weight:"fill"}),(null===(C=T[e.ruleId])||void 0===C?void 0:C.completed)==="fail"?"Marked":"Didn't Help"]}),(0,s.jsxs)("button",{onClick:()=>K(e.ruleId),className:"inline-flex items-center px-3 py-2 text-sm font-medium rounded-lg bg-gray-50 text-gray-700 border border-gray-300 hover:bg-gray-100",children:[(0,s.jsx)(x.Z,{size:16,className:"mr-1",weight:"fill"}),"Feedback"]})]})})]},e.ruleId)})})}),C.open&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Share Your Feedback"}),(0,s.jsx)("textarea",{value:_,onChange:e=>k(e.target.value),placeholder:"What worked? What didn't? Any suggestions?",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-microsoft-blue focus:border-transparent resize-none",rows:5}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 mt-4",children:[(0,s.jsx)("button",{onClick:()=>R({open:!1,recId:null}),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg",children:"Cancel"}),(0,s.jsx)("button",{onClick:()=>{if(!C.recId||!_.trim())return;let e=Array.from(O.planRecommendations.values()).filter(e=>e.recommendationId===C.recId)[0];e&&(O.createFeedback({planRecommendationId:e.id,feedbackType:"suggestion",feedbackText:_.trim(),sentiment:"neutral",submittedBy:"user@example.com"}),(0,N.j)("FEEDBACK_GIVEN",{planRecommendationId:e.id,eventData:{feedback:_.trim()}}),R({open:!1,recId:null}),k(""),alert("Thank you for your feedback!"))},className:"px-4 py-2 text-sm font-medium bg-microsoft-blue text-white rounded-lg hover:bg-blue-600",children:"Submit"})]})]})}),P.open&&P.rec&&P.template&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Log Activities"}),(0,s.jsx)("button",{onClick:()=>U({open:!1,rec:null,template:null}),className:"text-gray-400 hover:text-gray-600",children:(0,s.jsx)(b.Z,{size:24})})]}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900 mb-1",children:P.rec.scenario}),(0,s.jsx)("div",{className:"text-xs text-gray-600 mb-2",children:P.rec.metric}),(0,s.jsx)("div",{className:"text-xs text-gray-700 italic",children:P.rec.recommendation})]}),(0,s.jsxs)("div",{className:"mb-6 flex items-center justify-between bg-purple-50 border border-purple-200 rounded-lg p-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(v.Z,{size:20,className:"text-purple-700",weight:"fill"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Not sure what to enter?"})]}),(0,s.jsx)("button",{onClick:()=>{if(!P.template)return;let e=P.template.sampleData;F({audienceSize:e.audienceSize.toString(),activities:Object.fromEntries(Object.entries(e.activities).map(e=>{let[t,a]=e;return[t,a.toString()]}))})},className:"px-4 py-2 bg-purple-600 text-white text-sm font-medium rounded-lg hover:bg-purple-700",children:"Load Sample Activities"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\uD83C\uDFAF Total Audience Size"}),(0,s.jsx)("input",{type:"number",value:Z.audienceSize,onChange:e=>F({...Z,audienceSize:e.target.value}),placeholder:"e.g., 1000 users",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-microsoft-blue"}),(0,s.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Total number of users in your target audience"})]}),(0,s.jsxs)("div",{className:"border-t border-gray-200 pt-4",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Activities Performed"}),(0,s.jsx)("div",{className:"space-y-3",children:P.template.activities.map(e=>(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.icon," ",e.label]}),(0,s.jsx)("input",{type:"number",value:Z.activities[e.id]||"",onChange:t=>F({...Z,activities:{...Z.activities,[e.id]:t.target.value}}),placeholder:e.placeholder,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-microsoft-blue"}),(0,s.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:e.description})]},e.id))})]}),Object.values(Z.activities).some(e=>e&&parseInt(e)>0)&&Z.audienceSize&&(0,s.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-green-900 mb-2",children:"\uD83D\uDCCA Coverage Preview"}),(()=>{let{coverage:e,breakdown:t,totalReached:a}=function(e,t){let a=Object.values(e).filter(e=>e>0);if(0===a.length)return{coverage:0,breakdown:"No activities logged yet.",totalReached:0};let s=a.reduce((e,t)=>e+t,0),r=a.length>1?.7:1,n=Math.round(s*r),i=t>0?Math.min(n/t,1):0;Object.keys(e).filter(t=>e[t]>0);let l="\nTotal touches: ".concat(s.toLocaleString(),"\nEstimated unique users: ").concat(n.toLocaleString()," (").concat((100*r).toFixed(0),"% uniqueness factor)\nAudience size: ").concat(t.toLocaleString(),"\nCoverage: ").concat((100*i).toFixed(1),"%\n\nCalculation: ").concat(n.toLocaleString()," unique users \xf7 ").concat(t.toLocaleString()," audience = ").concat((100*i).toFixed(1),"%\n  ").trim();return{coverage:i,breakdown:l,totalReached:n}}(Object.fromEntries(Object.entries(Z.activities).filter(e=>{let[t,a]=e;return a&&parseInt(a)>0}).map(e=>{let[t,a]=e;return[t,parseInt(a)]})),parseInt(Z.audienceSize)||1e3);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"text-2xl font-bold text-green-700 mb-2",children:[(100*e).toFixed(1),"% Coverage"]}),(0,s.jsx)("div",{className:"text-xs text-gray-700 whitespace-pre-line",children:t}),(0,s.jsx)("div",{className:"mt-3 p-3 bg-white rounded border border-green-300",children:(0,s.jsxs)("p",{className:"text-xs text-gray-700",children:[(0,s.jsx)("strong",{children:"How this helps:"})," ",P.template.explanation]})})]})})()]}),(0,s.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:(0,s.jsxs)("p",{className:"text-xs text-gray-700",children:[(0,s.jsx)("strong",{children:"\uD83D\uDCA1 Tip:"})," These activities contribute to the ",(0,s.jsx)("strong",{children:"Coverage"})," metric in your Evidence Score. Higher coverage = stronger proof your recommendation worked!"]})})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 mt-6 pt-4 border-t border-gray-200",children:[(0,s.jsx)("button",{onClick:()=>U({open:!1,rec:null,template:null}),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),(0,s.jsx)("button",{onClick:()=>{if(!P.rec)return;let e=Array.from(O.planRecommendations.values()).filter(e=>e.recommendationId===P.rec.ruleId)[0];if(!e){alert("Please add to plan first");return}let t=parseInt(Z.audienceSize)||1e3,a={};if(Object.entries(Z.activities).forEach(e=>{let[t,s]=e,r=parseInt(s);!isNaN(r)&&r>0&&(a[t]=r)}),0===Object.keys(a).length){alert("Please enter at least one activity");return}Object.entries(a).forEach(a=>{let[s,r]=a;(0,N.j)("OUTREACH_SENT",{planRecommendationId:e.id,eventData:{activityType:s,count:r,audienceSize:t,recordedBy:"user@example.com"}})}),U({open:!1,rec:null,template:null}),alert("✅ ".concat(Object.keys(a).length," activities logged successfully!"))},className:"px-4 py-2 bg-microsoft-blue text-white font-medium rounded-lg hover:bg-blue-600",children:"Log Activities"})]})]})]})})]})}}},function(e){e.O(0,[113,547,187,515,971,117,744],function(){return e(e.s=7096)}),_N_E=e.O()}]);